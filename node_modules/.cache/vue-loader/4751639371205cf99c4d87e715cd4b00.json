{"remainingRequest":"/Users/wangyijie/trunks/vue/supermall/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangyijie/trunks/vue/supermall/src/views/detail/Detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangyijie/trunks/vue/supermall/src/views/detail/Detail.vue","mtime":1589544099463},{"path":"/Users/wangyijie/trunks/vue/supermall/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangyijie/trunks/vue/supermall/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/wangyijie/trunks/vue/supermall/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangyijie/trunks/vue/supermall/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBEZXRhaWxOYXZCYXIgZnJvbSAiLi9jaGlsZENvbXBzL0RldGFpbE5hdkJhciI7CmltcG9ydCBEZXRhaWxTd2lwZXIgZnJvbSAiLi9jaGlsZENvbXBzL0RldGFpbFN3aXBlciI7CmltcG9ydCBEZXRhaWxTaG9wSW5mbyBmcm9tICIuL2NoaWxkQ29tcHMvRGV0YWlsU2hvcEluZm8iOwppbXBvcnQgRGV0YWlsR29vZHNJbmZvIGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxHb29kc0luZm8iOwppbXBvcnQgRGV0YWlsQmFzZUluZm8gZnJvbSAiLi9jaGlsZENvbXBzL0RldGFpbEJhc2VJbmZvIjsKaW1wb3J0IERldGFpbFBhcmFtSW5mbyBmcm9tICIuL2NoaWxkQ29tcHMvRGV0YWlsUGFyYW1JbmZvIjsKaW1wb3J0IERldGFpbENvbW1lbnRJbmZvIGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxDb21tZW50SW5mbyI7CmltcG9ydCBEZXRhaWxCb3R0b21CYXIgZnJvbSAiLi9jaGlsZENvbXBzL0RldGFpbEJvdHRvbUJhciI7CmltcG9ydCBHb29kc0xpc3QgZnJvbSAiY29tcG9uZW50cy9jb250ZW50L2dvb2RzL0dvb2RzTGlzdCI7CmltcG9ydCBCYWNrVG9wIGZyb20gImNvbXBvbmVudHMvY29udGVudC9iYWNrVG9wL0JhY2tUb3AiOwoKaW1wb3J0IFNjcm9sbCBmcm9tICJjb21wb25lbnRzL2NvbW1vbi9zY3JvbGwvU2Nyb2xsIjsKaW1wb3J0IHtpdGVtTGlzdGVuZXJNaXhpbn0gZnJvbSAiY29tbW9uL21peGluIjsKCmltcG9ydCB7Z2V0RGV0YWlsLCBTaG9wLCBHb29kcywgR29vZHNQYXJhbSwgZ2V0UmVjb21tZW5kfSBmcm9tICIuLi8uLi9uZXR3b3JrL2RldGFpbCI7CmltcG9ydCB7ZGVib3VuY2V9IGZyb20gIi4uLy4uL2NvbW1vbi91dGlscyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkRldGFpbCIsCiAgY29tcG9uZW50czogewogICAgR29vZHNMaXN0LAogICAgRGV0YWlsTmF2QmFyLAogICAgRGV0YWlsU3dpcGVyLAogICAgRGV0YWlsU2hvcEluZm8sCiAgICBEZXRhaWxHb29kc0luZm8sCiAgICBEZXRhaWxCYXNlSW5mbywKICAgIERldGFpbFBhcmFtSW5mbywKICAgIERldGFpbENvbW1lbnRJbmZvLAogICAgU2Nyb2xsLAogICAgRGV0YWlsQm90dG9tQmFyLAogICAgQmFja1RvcAogIH0sCiAgLy/kvb/nlKjmt7flhaXmiorkuKTkuKrnu4Tku7blhoXlrrnov5vooYzlkIjlubYKICBtaXhpbnM6IFtpdGVtTGlzdGVuZXJNaXhpbl0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlpZDogbnVsbCwKICAgICAgdG9wSW1hZ2VzOiBbXSwKICAgICAgZ29vZHM6IHt9LAogICAgICBzaG9wOiB7fSwKICAgICAgZGV0YWlsSW5mbzoge30sCiAgICAgIHBhcmFtSW5mbzoge30sCiAgICAgIGNvbW1lbnRJbmZvOiB7fSwKICAgICAgcmVjb21tZW5kczogW10sCiAgICAgIHRoZW1lVG9wWXM6IFtdLAogICAgICBnZXRUaGVtZVRvcFk6IG51bGwsCiAgICAgIGN1cnJlbnRJbmRleDogMCwKICAgICAgaXNTaG93QmFja1RvcDogZmFsc2UKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmlpZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pZAoKICAgIC8vICDor7fmsYLor6bmg4XmlbDmja4KICAgIGdldERldGFpbCh0aGlzLmlpZCkudGhlbihyZXMgPT4gewogICAgICAvLyAxLuiOt+WPluaVsOaNrgogICAgICBjb25zdCBkYXRhID0gcmVzLnJlc3VsdAoKICAgICAgLy/ojrflj5bpobbpg6jova7mkq3mlbDmja4KICAgICAgdGhpcy50b3BJbWFnZXMgPSBkYXRhLml0ZW1JbmZvLnRvcEltYWdlcwogICAgICAvLyBjb25zb2xlLmxvZyhyZXMpCiAgICAgIC8vIDMu6I635Y+W5ZWG5ZOB5L+h5oGvCiAgICAgIHRoaXMuZ29vZHMgPSBuZXcgR29vZHMoZGF0YS5pdGVtSW5mbywgZGF0YS5jb2x1bW5zLCBkYXRhLnNob3BJbmZvLnNlcnZpY2VzKQogICAgICAvLyA0LuiOt+WPluW6l+mTuuS/oeaBrwogICAgICB0aGlzLnNob3AgPSBuZXcgU2hvcChkYXRhLnNob3BJbmZvKQogICAgICAvLyAg5L+d5a2Y5ZWG5ZOB6K+m5oOFCiAgICAgIHRoaXMuZGV0YWlsSW5mbyA9IGRhdGEuZGV0YWlsSW5mbwogICAgICAvLyAg6I635Y+W5Y+C5pWw5L+h5oGvCiAgICAgIHRoaXMucGFyYW1JbmZvID0gbmV3IEdvb2RzUGFyYW0oZGF0YS5pdGVtUGFyYW1zLmluZm8sIGRhdGEuaXRlbVBhcmFtcy5ydWxlKQogICAgICAvLyAg6I635Y+W6K+E6K665L+h5oGvCiAgICAgIGlmIChkYXRhLnJhdGUuY1JhdGUgIT09IDApIHsKICAgICAgICB0aGlzLmNvbW1lbnRJbmZvID0gZGF0YS5yYXRlLmxpc3RbMF0KICAgICAgfQoKICAgICAgLy/lvZPmlbDmja7muLLmn5Plrozmr5XkvJrlm57osIPov5nkuKrmlrnms5UKICAgICAgLy8gdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAvLyAgIC8vZG9t6Jm954S25Yqg6L295a6M5q+V77yM5L2G5piv5Zu+54mH5rKh5pyJ5Yqg6L295a6M5oiQCiAgICAgIC8vICAgdGhpcy50aGVtZVRvcFlzPVtdCiAgICAgIC8vICAgdGhpcy50aGVtZVRvcFlzLnB1c2goMCkKICAgICAgLy8gICB0aGlzLnRoZW1lVG9wWXMucHVzaCh0aGlzLiRyZWZzLnBhcmFtcy4kZWwub2Zmc2V0VG9wKQogICAgICAvLyAgIHRoaXMudGhlbWVUb3BZcy5wdXNoKHRoaXMuJHJlZnMucmVjb21tZW5kLiRlbC5vZmZzZXRUb3ApCiAgICAgIC8vICAgdGhpcy50aGVtZVRvcFlzLnB1c2godGhpcy4kcmVmcy5jb21tZW50LiRlbC5vZmZzZXRUb3ApCiAgICAgIC8vIH0pCiAgICB9KQoKICAgIC8vICDojrflj5bmjqjojZDmlbDmja4KICAgIGdldFJlY29tbWVuZCgpLnRoZW4ocmVzID0+IHsKICAgICAgdGhpcy5yZWNvbW1lbmRzID0gcmVzLmRhdGEubGlzdAogICAgICAvLyBjb25zb2xlLmxvZyhyZXMpCiAgICB9KQoKICAgIC8vICDnu5lnZXRUaGVtZVRvcFnotJ/lgLwKICAgIHRoaXMuZ2V0VGhlbWVUb3BZID0gZGVib3VuY2UoKCkgPT4gewogICAgICB0aGlzLnRoZW1lVG9wWXMgPSBbXQogICAgICB0aGlzLnRoZW1lVG9wWXMucHVzaCgwKQogICAgICB0aGlzLnRoZW1lVG9wWXMucHVzaCh0aGlzLiRyZWZzLnBhcmFtcy4kZWwub2Zmc2V0VG9wKQogICAgICB0aGlzLnRoZW1lVG9wWXMucHVzaCh0aGlzLiRyZWZzLmNvbW1lbnQuJGVsLm9mZnNldFRvcCkKICAgICAgdGhpcy50aGVtZVRvcFlzLnB1c2godGhpcy4kcmVmcy5yZWNvbW1lbmQuJGVsLm9mZnNldFRvcCkKICAgIH0sIDEwMCkKICB9LAogIG1vdW50ZWQoKSB7CiAgICBjb25zb2xlLmxvZygi5Luj56CB6L+b6KGM5re35YWlZGV0YWlsIikKICB9LAogIGRlc3Ryb3llZCgpIHsKICAgIC8v5Y+W5raI5YWo5bGA5LqL5Lu255qE55uR5ZCsCiAgICB0aGlzLiRidXMuJG9mZignaXRlbUltYWdlTG9hZCcsIHRoaXMuSXRlbUltZ0xpc3RlbmVyKQogIH0sCiAgbWV0aG9kczogewogICAgaW1hZ2VMb2FkKCkgewogICAgICAvLyB0aGlzLiRyZWZzLnNjcm9sbC5yZWZyZXNoKCkKICAgICAgdGhpcy5uZXdSZWZyZXNoKCkKCiAgICAgIC8v5Zu+54mH5Yqg6L295a6M5oiQ5Zue6LCD55qE5pe25YCZ6LCD55SoCiAgICAgIHRoaXMuZ2V0VGhlbWVUb3BZKCkKICAgIH0sCiAgICB0aXRsZUNsaWNrKGluZGV4KSB7CiAgICAgIGNvbnNvbGUubG9nKGluZGV4KQogICAgICB0aGlzLiRyZWZzLnNjcm9sbC5zY3JvbGxUbygwLCAtdGhpcy50aGVtZVRvcFlzW2luZGV4XSwgMjAwKQogICAgfSwKICAgIGNvbnRlbnRTY3JvbGwocG9zaXRpb24pIHsKICAgICAgLy8gY29uc29sZS5sb2cocG9zaXRpb24pCiAgICAgIC8vICDojrflj5Z55YC8CiAgICAgIGNvbnN0IHBvc2l0aW9uWSA9IC1wb3NpdGlvbi55CiAgICAgIC8vICDlkozkuLvpopjkuK3nmoR55YC86L+b6KGM5a+55q+UCiAgICAgIGxldCBsZW5ndGggPSB0aGlzLnRoZW1lVG9wWXMubGVuZ3RoCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICAvL+S9v+eUqGlu6I635Y+W55qEaeaYr+S4gOS4quWtl+espuS8oOS4jeaYr2ludOexu+Wei+S9v+eUqOaZrumAmueahOW+queOr+WImeS4jeS8mgogICAgICAgIGlmICh0aGlzLmN1cnJlbnRJbmRleCAhPT0gaSAmJiAoKHBvc2l0aW9uWSA+IHRoaXMudGhlbWVUb3BZc1tpXSAmJiBwb3NpdGlvblkgPCB0aGlzLnRoZW1lVG9wWXNbaSArIDFdKQogICAgICAgICAgfHwgKGkgPT09IGxlbmd0aCAtIDEgJiYgcG9zaXRpb25ZID49IHRoaXMudGhlbWVUb3BZc1tpXSkpCiAgICAgICAgKSB7CiAgICAgICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IGkKICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuY3VycmVudEluZGV4KQogICAgICAgICAgdGhpcy4kcmVmcy5uYXZzLmN1cnJlbnRJbmRleCA9IHRoaXMuY3VycmVudEluZGV4CiAgICAgICAgfQogICAgICB9CiAgICAgIC8v5Yik5pat5LiK5ruR5oyJ6ZKu5piv5ZCm5pi+56S6CiAgICAgIHRoaXMuaXNTaG93QmFja1RvcCA9ICgtcG9zaXRpb24ueSkgPiAxMDAwCiAgICB9LAogICAgYmFja0NsaWNrKCkgewogICAgICBjb25zb2xlLmxvZygnZGRkJykKICAgICAgdGhpcy4kcmVmcy5zY3JvbGwuc2Nyb2xsVG8oMCwgMCkKICAgIH0sCiAgICBhZGRUb0NhcnQoKXsKICAgIC8vICDojrflj5botK3nianovabpnIDopoHlsZXnpLrkv6Hmga8KICAgICAgY29uc3QgcHJvZHVjdD17fQogICAgICBwcm9kdWN0LmltYWdlPXRoaXMudG9wSW1hZ2VzWzBdCiAgICAgIHByb2R1Y3QudGl0bGU9dGhpcy5nb29kcy50aXRsZQogICAgICBwcm9kdWN0LmRlc2M9dGhpcy5nb29kcy5kZXNjCiAgICAgIHByb2R1Y3QucHJpY2U9dGhpcy5nb29kcy5uZXdQcmljZQogICAgICBwcm9kdWN0LmlpZD10aGlzLmlpZAoKICAgIC8vICDlsIbllYblk4Hmt7vliqDliLDotK3nianovaYKCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["Detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA","file":"Detail.vue","sourceRoot":"src/views/detail","sourcesContent":["<template>\n  <div id=\"detail\">\n    <DetailNavBar class=\"detail-nav\" @titleClick=\"titleClick\" ref=\"navs\"/>\n    <scroll class=\"content\" ref=\"scroll\" :probe-type=\"3\" @scroll=\"contentScroll\">\n      <detail-swiper :top-images=\"topImages\"/>\n      <detail-base-info :goods=\"goods\"/>\n      <detail-shop-info :shop=\"shop\"/>\n      <detail-goods-info :detailInfo=\"detailInfo\" @imageLoad=\"imageLoad\"/>\n      <detail-param-info ref=\"params\" :param-info=\"paramInfo\"/>\n      <detail-comment-info ref=\"comment\" :commentInfo=\"commentInfo\"/>\n      <goods-list ref=\"recommend\" :goods=\"recommends\"/>\n    </scroll>\n    <DetailBottomBar @addToCart=\"addToCart\"/>\n    <BackTop @click.native=\"backClick\" v-show=\"isShowBackTop\"/>\n  </div>\n</template>\n\n<script>\n  import DetailNavBar from \"./childComps/DetailNavBar\";\n  import DetailSwiper from \"./childComps/DetailSwiper\";\n  import DetailShopInfo from \"./childComps/DetailShopInfo\";\n  import DetailGoodsInfo from \"./childComps/DetailGoodsInfo\";\n  import DetailBaseInfo from \"./childComps/DetailBaseInfo\";\n  import DetailParamInfo from \"./childComps/DetailParamInfo\";\n  import DetailCommentInfo from \"./childComps/DetailCommentInfo\";\n  import DetailBottomBar from \"./childComps/DetailBottomBar\";\n  import GoodsList from \"components/content/goods/GoodsList\";\n  import BackTop from \"components/content/backTop/BackTop\";\n\n  import Scroll from \"components/common/scroll/Scroll\";\n  import {itemListenerMixin} from \"common/mixin\";\n\n  import {getDetail, Shop, Goods, GoodsParam, getRecommend} from \"../../network/detail\";\n  import {debounce} from \"../../common/utils\";\n\n  export default {\n    name: \"Detail\",\n    components: {\n      GoodsList,\n      DetailNavBar,\n      DetailSwiper,\n      DetailShopInfo,\n      DetailGoodsInfo,\n      DetailBaseInfo,\n      DetailParamInfo,\n      DetailCommentInfo,\n      Scroll,\n      DetailBottomBar,\n      BackTop\n    },\n    //使用混入把两个组件内容进行合并\n    mixins: [itemListenerMixin],\n    data() {\n      return {\n        iid: null,\n        topImages: [],\n        goods: {},\n        shop: {},\n        detailInfo: {},\n        paramInfo: {},\n        commentInfo: {},\n        recommends: [],\n        themeTopYs: [],\n        getThemeTopY: null,\n        currentIndex: 0,\n        isShowBackTop: false\n      }\n    },\n    created() {\n      this.iid = this.$route.params.id\n\n      //  请求详情数据\n      getDetail(this.iid).then(res => {\n        // 1.获取数据\n        const data = res.result\n\n        //获取顶部轮播数据\n        this.topImages = data.itemInfo.topImages\n        // console.log(res)\n        // 3.获取商品信息\n        this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services)\n        // 4.获取店铺信息\n        this.shop = new Shop(data.shopInfo)\n        //  保存商品详情\n        this.detailInfo = data.detailInfo\n        //  获取参数信息\n        this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule)\n        //  获取评论信息\n        if (data.rate.cRate !== 0) {\n          this.commentInfo = data.rate.list[0]\n        }\n\n        //当数据渲染完毕会回调这个方法\n        // this.$nextTick(() => {\n        //   //dom虽然加载完毕，但是图片没有加载完成\n        //   this.themeTopYs=[]\n        //   this.themeTopYs.push(0)\n        //   this.themeTopYs.push(this.$refs.params.$el.offsetTop)\n        //   this.themeTopYs.push(this.$refs.recommend.$el.offsetTop)\n        //   this.themeTopYs.push(this.$refs.comment.$el.offsetTop)\n        // })\n      })\n\n      //  获取推荐数据\n      getRecommend().then(res => {\n        this.recommends = res.data.list\n        // console.log(res)\n      })\n\n      //  给getThemeTopY负值\n      this.getThemeTopY = debounce(() => {\n        this.themeTopYs = []\n        this.themeTopYs.push(0)\n        this.themeTopYs.push(this.$refs.params.$el.offsetTop)\n        this.themeTopYs.push(this.$refs.comment.$el.offsetTop)\n        this.themeTopYs.push(this.$refs.recommend.$el.offsetTop)\n      }, 100)\n    },\n    mounted() {\n      console.log(\"代码进行混入detail\")\n    },\n    destroyed() {\n      //取消全局事件的监听\n      this.$bus.$off('itemImageLoad', this.ItemImgListener)\n    },\n    methods: {\n      imageLoad() {\n        // this.$refs.scroll.refresh()\n        this.newRefresh()\n\n        //图片加载完成回调的时候调用\n        this.getThemeTopY()\n      },\n      titleClick(index) {\n        console.log(index)\n        this.$refs.scroll.scrollTo(0, -this.themeTopYs[index], 200)\n      },\n      contentScroll(position) {\n        // console.log(position)\n        //  获取y值\n        const positionY = -position.y\n        //  和主题中的y值进行对比\n        let length = this.themeTopYs.length\n        for (let i = 0; i < length; i++) {\n          //使用in获取的i是一个字符传不是int类型使用普通的循环则不会\n          if (this.currentIndex !== i && ((positionY > this.themeTopYs[i] && positionY < this.themeTopYs[i + 1])\n            || (i === length - 1 && positionY >= this.themeTopYs[i]))\n          ) {\n            this.currentIndex = i\n            console.log(this.currentIndex)\n            this.$refs.navs.currentIndex = this.currentIndex\n          }\n        }\n        //判断上滑按钮是否显示\n        this.isShowBackTop = (-position.y) > 1000\n      },\n      backClick() {\n        console.log('ddd')\n        this.$refs.scroll.scrollTo(0, 0)\n      },\n      addToCart(){\n      //  获取购物车需要展示信息\n        const product={}\n        product.image=this.topImages[0]\n        product.title=this.goods.title\n        product.desc=this.goods.desc\n        product.price=this.goods.newPrice\n        product.iid=this.iid\n\n      //  将商品添加到购物车\n\n      }\n    }\n  }\n</script>\n\n<style scoped>\n  #detail {\n    position: relative;\n    z-index: 9;\n    background-color: #fff;\n    height: 100vh;\n  }\n\n  .content {\n    height: calc(100% - 44px - 49px);\n  }\n\n  .detail-nav {\n    position: relative;\n    z-index: 9;\n    background-color: #fff;\n  }\n</style>\n"]}]}